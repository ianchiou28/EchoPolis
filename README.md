# 🌆 Echopolis (回声都市)

> 一个超个人化AI驱动的社会金融模拟器

## 📋 项目概述

Echopolis是一个创新的金融模拟游戏，玩家通过"意识回响"与AI化身互动，在虚拟的金融世界中体验决策的深远影响。每个AI化身都基于MBTI人格类型和独特的命运背景，拥有自主的决策逻辑和行为模式。

### 🎯 核心理念
- **个人化体验**: 基于MBTI人格的真实映射
- **AI驱动**: DeepSeek AI提供智能决策和对话
- **回响机制**: 玩家通过自然语言影响AI决策
- **金融模拟**: 真实的资产管理和现金流系统

## ✨ 核心特色

### 🧠 MBTI人格系统
- **16种人格类型**: 每种都有独特的决策特征和行为倾向
- **诗意化描述**: 富有文学性的人格画像
- **决策影响**: 不同类型在面临选择时有不同倾向
  - **INTP**: 容易分析瘫痪，但理论导向强
  - **ENTJ**: 决策果断，偏好高风险高收益
  - **ISTJ**: 保守稳健，偏好传统投资
  - **ESFP**: 情绪化决策，容易受社交影响

### 🎲 命运轮盘系统
- **8种出身背景**: 从亿万富豪到低收入户的多样化起点
- **初始资源差异**: 不同命运提供不同的初始资金和特质
- **背景故事**: 每种命运都有独特的背景描述和特殊能力

### 💭 意识回响机制
- **自然语言交互**: 通过文字与AI化身交流
- **智能分析**: 系统分析玩家意图和情感倾向
- **信任度系统**: 基于历史表现的动态影响权重
- **干预点数**: 每日限制的影响次数，增加策略性

### 🤖 DeepSeek AI集成
- **智能决策**: 使用DeepSeek AI进行真实的人格化决策
- **AI情况生成**: 每次遇到的情况都由AI根据角色状态动态生成
- **个性化体验**: AI根据MBTI类型和背景生成符合角色的情况
- **智能对话**: 真实的AI内心想法和情感表达（限制150字符）

### 💰 金融系统
- **回合制**: 每个决策 = 1回合 = 1个月
- **现金流管理**: 总资产 - 长期投资 - 锁定投资
- **锁定投资**: 支持多回合锁定的投资项目
- **破产机制**: 现金流为负时游戏失败
- **中央银行**: 监控和调控经济系统

## 🚀 快速开始

### 安装要求
```bash
# Python 3.8+
pip install requests

# 配置DeepSeek API Key (可选)
# 编辑 config.json 文件
{
  "deepseek_api_key": "sk-your-api-key-here"
}
```

### 运行游戏

#### 命令行版本
```bash
cd echopolis
python echopolis_game.py
```

#### GUI版本 (🆕 新增!)
```bash
# 安装pygame依赖
pip install pygame

# 启动GUI版本
python start_gui.py
# 或
python echopolis_gui.py
```

### 基本指令
- `create <MBTI> <姓名>` - 创建AI化身
- `status` - 查看状态
- `situation` - 生成情况
- `echo <建议>` - 发送回响
- `decide` - AI自主决策
- `round` / `next` - 推进回合
- `save` / `load` - 保存/加载游戏
- `help` - 显示帮助
- `quit` - 退出游戏

## 🎮 完整游戏流程

### AI模式 vs 规则模式
- **AI模式**: 配置了DeepSeek API Key后，所有情况和决策都由AI生成
- **规则模式**: 未配置API Key时，使用预设的规则系统

### 1. 创建AI化身
```
🎮 请输入指令: create INTP Alex
🎉 成功创建AI化身: Alex (INTP)
🎲 命运轮盘结果: 📚 书香门第
💰 初始资金: 1,000,000 CP
🤖 AI模式: DeepSeek AI决策
```

**系统会随机分配命运轮盘结果，可能获得：**
- 🏆 亿万富豪 (100,000,000 CP)
- 📚 书香门第 (1,000,000 CP)
- 💔 家道中落 (10,000 CP)
- 🏭 工人家庭 (50,000 CP)
- 👨👩👧👦 中产阶级 (200,000 CP)
- 💼 白手起家 (30,000 CP)
- 💰 低收入户 (25,000 CP)
- 🎭 艺术世家 (150,000 CP)

### 2. 生成决策情况
```
🎮 请输入指令: situation
📋 新情况出现! (由DeepSeek AI生成)
📝 情况描述: 作为刚毕业的INTP型金融分析师，你发现母校经济学院正在募集校友基金...
🔀 可选择的行动:
   1. 投资60万CP到校友基金（锁定3年，年化8%-15%回报）
   2. 接受工作机会并租房（职业发展优先）
   3. 购置800万CP的学区房（首付100万CP）
```

### 3. 发送意识回响
```
🎮 请输入指令: echo 我建议你选择第二个选项，先稳定工作再考虑投资
💭 你的回响: '我建议你选择第二个选项，先稳定工作再考虑投资'
📊 回响分析: advisory | 置信度: 0.85
🎯 影响权重: 0.65
⚡ 剩余干预点数: 9

🤖 AI决策: 接受工作机会并租房（职业发展优先）
📈 信任度变化: +3 (当前: 53)
💰 资产变化: +5,000 CP (工作收入)
💵 现金流变化: -2,000 CP (租房支出)
💳 资产总量: 1,005,000 CP
💵 现金流: +1,003,000 CP

💡 AI内心独白: 你的建议很有道理，稳定的工作是基础，投资可以等有了更多经验再考虑...
```

### 4. 推进回合
```
🎮 请输入指令: round
📅 第2回合开始!
⚡ 精力恢复: 100/100
😌 压力缓解: 45/100
🎯 干预点数重置: 10/10
🔒 锁定投资: 0项
```

## 🏗️ 系统架构

### 核心模块
```
echopolis/
├── core/
│   ├── avatar/
│   │   └── ai_avatar.py          # AI化身核心逻辑
│   ├── systems/
│   │   ├── mbti_traits.py        # MBTI人格特质系统
│   │   ├── fate_wheel.py         # 命运轮盘系统
│   │   ├── echo_system.py        # 回响交互系统
│   │   └── asset_calculator.py   # 资产计算系统
│   ├── entities/
│   │   ├── person.py             # Person实体（参考AIvilization）
│   │   ├── brain.py              # Brain思维模块
│   │   ├── action.py             # Action行动系统
│   │   └── god.py                # 中央银行管理器
│   └── ai/
│       └── deepseek_engine.py    # DeepSeek AI引擎
├── echopolis_game.py             # 主游戏系统
└── test_echopolis.py             # 测试文件
```

### 技术栈
- **语言**: Python 3.8+
- **AI引擎**: DeepSeek API
- **架构模式**: 参考AIvilization的Person-Brain-Action结构
- **数据存储**: JSON文件存储

## 🔧 核心机制

### 信任度系统
- **初始信任度**: 50/100
- **好建议被采纳**: +2~5
- **坏建议导致损失**: -5~10
- **信任度影响**: 决定回响的权重和AI采纳概率

### 状态系统
- **健康**: 影响决策效率和生活质量
- **精力**: 每回合行动消耗，影响决策能力
- **幸福感**: 影响决策理性和风险偏好
- **压力**: 高压力时倾向保守决策

### 资产管理
- **总资产**: 所有财富的总和
- **现金流**: 可用于日常开支的流动资金
- **长期投资**: 房产、基金等长期资产
- **锁定投资**: 有期限限制的投资项目

## 🧪 测试系统

运行测试验证系统功能：

```bash
# 基础功能测试
python test_echopolis.py

# AI情况生成测试
python test_ai_situation.py
```

测试包括：
- AI化身创建
- AI情况生成
- 回响系统
- DeepSeek AI决策
- 状态显示

## 📊 当前状态

### ✅ 已完成功能
- [x] MBTI人格系统 (16种类型)
- [x] 命运轮盘系统 (8种出身)
- [x] DeepSeek AI集成
- [x] 意识回响机制
- [x] 资产计算系统
- [x] 现金流管理
- [x] 锁定投资系统
- [x] 破产机制
- [x] 中央银行监控
- [x] 回合制时间系统

### ✅ 新增功能 - GUI版本
- [x] 像素风格游戏界面
- [x] 中文字体支持系统
- [x] 场景管理系统
- [x] 2D地图和建筑系统
- [x] 实时UI面板
- [x] 多人模式预留

### 🔄 开发中功能
- [ ] GUI与核心系统集成
- [ ] 建筑功能实现
- [ ] 多人在线系统
- [ ] 更丰富的事件库
- [ ] 宏观经济模拟

## 🔮 未来规划

### Phase 2: 社交系统
- 多人在线互动
- 用户间交易系统
- 社交网络影响
- 合作投资项目

### Phase 3: 经济生态
- 宏观经济模拟
- 市场波动系统
- 真实金融产品对接
- 经济周期影响

### Phase 4: 沉浸体验
- 3D可视化界面
- VR/AR支持
- 语音交互
- 情感识别

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

### 开发环境设置
```bash
git clone <repository>
cd echopolis
pip install -r requirements.txt
python test_echopolis.py  # 运行测试
```

### 代码规范
- 遵循PEP 8
- 添加适当的注释和文档
- 编写单元测试
- 保持模块化设计

## 📄 许可证

MIT License

---

**Echopolis** - 在回声中聆听选择的力量 🌆✨

*"每一个决策都是一次回响，每一次回响都塑造着未来"*