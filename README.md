# 🌆 EchoPolis (回声都市)

>由AI驱动的社会金融模拟器：重新定义金融教育，让每个年轻人都拥有自己的财富人生沙盘 

## 一、 项目概述

EchoPolis是一个突破性的金融行为洞察引擎，融合AIGC与数字孪生技术，为Z世代打造安全可控的"第二人生"财富体验。通过"意识回响"与DeepSeek AI化身深度互动，用户在零风险环境中探索金融决策、理解风险与成长，获得真实而深刻的财商教育。

### 1. 核心设计哲学
- **一面镜子** (自我认知): AI化身精准映射你的决策模式、风险偏好与思维惯性
- **一个回响** (玩法灵魂): 语言干预如投石入湖，激起层层涟漪，模拟现实选择的复杂性
- **一个沙盘** (核心价值): 绝对安全的实验场，无惧风险地体验贷款、创业、投资的全过程

### 2. 核心特色
- **DeepSeek AI驱动**: 真正的AI思考与决策，构建有"灵魂"的金融新物种
- **MBTI人格系统**: 16种人格类型的"意识复刻"，还原不同人格的决策特质
- **意识回响机制**: 非线性语言干预，基于信任度的动态影响权重系统
- **完整金融生态**: 宏观经济周期、个人财务管理、社交化投资决策
- **命运轮盘**: 8种社会阶层起点，差异化的人生轨迹与成长路径
- **行为洞察**: 沉淀独特的金融行为数据，构建个性化用户画像
- 
## 二、 项目价值：构建未来金融教育新范式

### 1. 突破性AI应用
- **有"灵魂"的AI**: 不是冰冷算法，而是有情感、有成长的数字生命体
- **人格一致性**: 严格按照MBTI特质的决策逻辑，真实还原个体思维模式
- **非线性交互**: 每次对话都可能产生意想不到的结果，模拟现实复杂性

### 2. 科学的教育方法论
- **体验式学习**: 在"做中学"，通过试错获得深刻理解
- **个性化成长**: 基于用户画像的定制化财商提升路径
- **安全试错环境**: 零风险体验高风险决策，获得宝贵经验

### 3. 真实的金融生态
- **全生命周期**: 从储蓄到投资、从单身到家庭的完整财务管理
- **宏观微观结合**: 个人决策与经济周期的动态交互
- **社会化金融**: AI化身间的协作竞争，模拟真实社交金融场景

### 4. 社会价值与使命
- **金融普惠**: 让金融知识不再是"有钱人的游戏"，人人可学、人人能懂
- **风险教育**: 在虚拟世界中识别金融陷阱，提升现实防骗能力
- **长期主义**: 培养正确的财富观与风险观，促进理性投资文化

### 5. 核心竞争优势
- **安全性**: 零风险试错环境，让年轻人安心探索金融世界
- **科学性**: 基于行为金融学与心理学的严谨设计
- **成长性**: 不仅是游戏，更是陪伴一生的财富成长伙伴

## 三、 产品特色"

### 1. AI"行为皮层"系统
- **真实AI思考**: 基于加权决策矩阵的智能决策 = 长期目标 + 短期情绪 + 性格特质 + 玩家干预 + 随机扰动
- **动态情况生成**: AI根据宏观经济、个人状态、社交关系生成复杂决策场景
- **智能投资分析**: 提供具体项目评估、风险分析与收益预测

### 2. MBTI人格系统
- **16种人格类型**: 每种类型都有独特的决策模式
  - **INTJ**: "建筑师" - 富有想象力和战略性的思想家，一切皆在计划中
  - **INTP**: "逻辑学家" - 具有创造性的发明家，对知识有着止不住的渴望
  - **ENTJ**: "指挥官" - 大胆、富有想象力的强势领导者，总能找到或创造解决方法
  - **ENTP**: "辩论家" - 聪明好奇的思想家，不会放弃任何挑战
  - **INFJ**: "提倡者" - 安静而神秘，同时鼓舞他人的理想主义者
  - **INFP**: "调停者" - 诗意、善良的利他主义者，总是热心为正义而战
  - **ENFJ**: "主人公" - 魅力非凡的领导者，能够使听众着迷
  - **ENFP**: "竞选者" - 热情、有创造性的社交者，总能找到微笑的理由
  - **ISTJ**: "物流师" - 实用主义的现实主义者，可靠性无可置疑
  - **ISFJ**: "守护者" - 非常专注而温暖的守护者，时刻准备保护爱着的人们
  - **ESTJ**: "总经理" - 出色的管理者，在管理事物或人员方面无与伦比
  - **ESFJ**: "执政官" - 极有同情心，善于社交，总是热心帮助他人
  - **ISTP**: "鉴赏家" - 大胆而实际的实验家，擅长使用各种工具
  - **ISFP**: "探险家" - 灵活、迷人的艺术家，时刻准备探索新的可能性
  - **ESTP**: "企业家" - 聪明、精力充沛的感知者，真正享受生活在边缘
  - **ESFP**: "表演者" - 自发、精力充沛的娱乐者，生活因他们而精彩

### 3. "意识回响"核心玩法
- **四类干预方式**: 启发(引导思考)、建议(具体操作)、指令(可能被拒绝)、情绪调节(鼓励/警告)
- **信任度演化**: 建议奏效→信任上升→更易采纳；频繁误导→信任下降→甚至无视
- **非线性反馈**: 你的一句话如石投湖心，AI反应往往超出预期，模拟现实复杂性
- **深度理解**: AI不仅执行指令，更能理解意图、情感与潜在动机

### 4. "宏观世界"经济系统
- **动态经济周期**: 模拟通胀、房价波动、股市崩盘等宏观事件
- **多层次投资**: 短期(1-3月)、中期(4-8月)、长期(9月+)投资组合管理
- **社交化金融**: AI化身间的合作、竞争、借贷与婚姻关系
- **宏观NPC**: 政府(调控政策)、银行(放贷)、企业(招聘/解雇)的动态交互
- **真实现金流**: 基于社会阶层的差异化收支，完整的破产与重生机制

### 5. 命运轮盘
- **8种出身**: 从亿万富豪到低收入户的不同起点
- **差异化开销**: 不同阶级有不同的月度生活成本
- **特殊背景**: 每种命运都有独特的背景故事和特质

## 四、 快速开始

### 1. 环境要求
- **Python 3.8+**
- **Node.js 16+**
- **DeepSeek API Key** (获取AI功能)

### 2. 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd EchoPolis
```

2. **安装依赖**
```bash
# Python依赖
pip install -r requirements.txt

# 前端依赖
cd frontend
npm install
cd ..
```

3. **配置API Key**
```bash
# 编辑 config.json
{
  "deepseek_api_key": "sk-your-deepseek-api-key"
}
```

### 3. 启动游戏

**一键启动（推荐）**
```bash
python start_full.py
```

**分别启动**
```bash
# 后端服务
python backend/start_backend_only.py

# 前端服务（新终端）
cd frontend && npm run dev
```

**访问地址**
```bash
- 🎮 **游戏界面**: http://localhost:3001
- 🔧 **后端API**: http://localhost:8000
- 📚 **API文档**: http://localhost:8000/docs
```
## 五、 游戏流程

### 1. 创建账户和AI化身
```
🔐 注册/登录账户
🎭 选择MBTI人格类型 (如: INTP - 逻辑学家)
✏️ 输入AI化身姓名
🎲 命运轮盘决定出身背景
💰 获得初始资金和特殊属性
```

### 2. AI生成决策情况
```
🤖 DeepSeek AI根据你的状态生成个性化情况:

"作为INTP型的Alex，你刚入职科技公司担任数据分析师。
大学导师联系你参与量化投资课程，学费12,000 CP，
但你发现租住环境有霉菌问题需要搬家..."

📋 AI提供3个选择:
1. 优先投资教育 - 支付课程费用
2. 改善居住环境 - 搬到更好的地方  
3. 保守策略 - 维持现状并储蓄
```

### 3. 意识回响互动
```
💭 输入你的建议:
"我建议优先投资教育，长期收益更重要"

🤖 AI分析并决策:
"你的建议很有道理。作为INTP，我确实更重视知识积累...
虽然居住环境不佳会影响健康，但这个学习机会难得。"

📊 决策结果:
✅ 选择: 优先投资教育
💰 现金: -12,000 CP
❤️ 健康: -5 (居住环境)
🧠 能力: +10 (教育投资)
🤝 信任度: +3 (采纳建议)
```

### 4. AI自主投资
```
💰 点击"AI投资"按钮
🤖 AI分析当前财务状况
📊 AI决定投资项目、金额和期限
💼 投资自动保存到数据库
📈 在资产分析页面查看投资详情
```

### 5. 沙盘世界探索
```
🌆 进入沙盘世界
🏦 访问银行 - 购买理财产品
📈 访问交易所 - 投资股票基金
🏢 访问房产中心 - 购买不动产
🏪 访问商业区 - 创业开店
🎓 访问教育机构 - 提升能力
```

### 6. 持续游戏循环
```
🔄 点击"推进1个月"
💵 自动发放月工资
💸 扣除月度生活开销
📈 投资项目自动更新
💰 到期投资自动结算
🎲 AI生成新的决策情况
```

## 六、 技术架构

### 1. 系统结构
```
EchoPolis/
├── core/                           # 🎮 核心游戏引擎
│   ├── ai/
│   │   └── deepseek_engine.py     # DeepSeek AI集成，处理AI决策
│   ├── avatar/
│   │   └── ai_avatar.py           # AI化身逻辑，管理角色状态
│   ├── entities/
│   │   ├── brain.py               # 决策大脑模块，处理决策流程
│   │   └── person.py              # 人物实体，存储角色属性
│   ├── systems/
│   │   ├── mbti_traits.py         # MBTI人格系统
│   │   ├── fate_wheel.py          # 命运轮盘系统
│   │   ├── investment_system.py   # 投资管理系统
│   │   └── asset_calculator.py    # 资产计算器
│   └── database/
│       └── database.py            # SQLite数据持久化
│
├── backend/                        # 🔧 FastAPI后端服务
│   ├── app/
│   │   ├── api/
│   │   │   └── routes.py          # RESTful API路由
│   │   ├── services/
│   │   │   └── game_service.py    # 游戏业务逻辑
│   │   └── models/
│   │       └── requests.py        # 请求数据模型
│   └── start_backend_only.py      # 后端启动脚本
│
├── frontend/                       # 🎨 Vue.js前端界面
│   ├── src/
│   │   ├── views/
│   │   │   ├── Login.vue          # 登录页面
│   │   │   ├── CharacterSelect.vue # 角色选择页面
│   │   │   ├── Home.vue           # 主游戏界面
│   │   │   ├── Assets.vue         # 资产分析页面
│   │   │   ├── World.vue          # 沙盘世界页面
│   │   │   └── Profile.vue        # 个人资料页面
│   │   ├── components/            # UI组件
│   │   ├── stores/
│   │   │   ├── game.js            # 游戏状态管理(Pinia)
│   │   │   └── theme.js           # 主题管理
│   │   └── router/
│   │       └── index.js           # 路由配置
│   └── package.json               # 前端依赖配置
│
├── echopolis.db                    # 💾 SQLite数据库文件
├── config.json                     # ⚙️ 配置文件(DeepSeek API Key)
├── requirements.txt                # 📦 Python依赖
├── start.py                        # 🚀 一键启动脚本
└── README.md                       # 📖 项目文档
```

**目录说明：**

- **core/** - 核心游戏逻辑，独立于前后端，可复用
  - `ai/` - AI引擎，与DeepSeek API交互
  - `avatar/` - AI化身管理，处理角色生命周期
  - `entities/` - 游戏实体，如人物、大脑等
  - `systems/` - 各种游戏系统（MBTI、投资、资产等）
  - `database/` - 数据持久化层

- **backend/** - 后端API服务
  - `api/routes.py` - 所有API端点定义
  - `services/` - 业务逻辑层
  - `models/` - 数据模型定义

- **frontend/** - 前端用户界面
  - `views/` - 页面组件
  - `stores/` - 状态管理(Pinia)
  - `router/` - 路由配置

### 2. 技术栈

**后端技术：**
- **语言**: Python 3.8+
- **Web框架**: FastAPI (高性能异步框架)
- **AI引擎**: DeepSeek API (大语言模型)
- **数据库**: SQLite (轻量级关系数据库)
- **HTTP客户端**: Requests (API调用)

**前端技术：**
- **框架**: Vue 3 (组合式API)
- **构建工具**: Vite (快速开发服务器)
- **状态管理**: Pinia (Vue官方状态库)
- **HTTP客户端**: Axios (异步请求)
- **路由**: Vue Router (单页应用路由)

**架构特点：**
- **前后端分离**: RESTful API通信
- **模块化设计**: 核心逻辑独立可复用
- **AI驱动**: DeepSeek提供真实智能决策
- **数据持久化**: SQLite存储用户数据
- **实时同步**: 所有操作立即保存

### 3. 数据流
```
用户操作 → 前端(Vue) → API请求(Axios) → 后端(FastAPI) 
    ↓
核心引擎(core/) → AI决策(DeepSeek) → 数据库(SQLite)
    ↓
API响应 → 前端更新 → 状态管理(Pinia) → 界面刷新
```

## 七、 核心机制

### 1. AI决策系统
- **DeepSeek驱动**: 真实的AI分析和决策，非预设脚本
- **人格一致性**: AI严格按照MBTI特质进行决策
- **上下文感知**: 考虑当前财务状况、健康状态、历史决策
- **动态学习**: 根据玩家反馈调整决策权重

**核心代码示例：**
```python
# AI决策引擎 - core/ai/deepseek_engine.py
class DeepSeekEngine:
    def make_decision(self, context: Dict) -> Dict:
        """AI做出投资决策"""
        prompt = f"""
        你是{context['mbti']}人格，现金{context['cash']:,}CP
        
        情况：{context['situation']}
        选项：{context['options']}
        
        请决策并返回JSON格式：
        {{
            "chosen_option": "选择的选项",
            "ai_thoughts": "决策思考过程",
            "investment": {{
                "name": "投资项目名",
                "amount": 金额,
                "duration": 期限(月),
                "type": "SHORT_TERM/MEDIUM_TERM/LONG_TERM"
            }}
        }}
        """
        
        response = requests.post(
            "https://api.deepseek.com/v1/chat/completions",
            headers={"Authorization": f"Bearer {self.api_key}"},
            json={
                "model": "deepseek-chat",
                "messages": [{"role": "user", "content": prompt}],
                "temperature": 0.7
            }
        )
        
        return self._parse_ai_response(response.json())
```

### 2. 信任度机制
- **初始信任**: 50/100
- **信任增长**: 好建议被采纳且结果良好 (+2~5)
- **信任下降**: 坏建议导致损失 (-5~10)
- **影响权重**: 高信任度时AI更重视玩家建议

**核心代码示例：**
```python
# 决策大脑 - core/entities/brain.py
class Brain:
    def process_decision(self, situation: str, options: List[str], 
                        player_echo: Optional[str] = None) -> Dict:
        """处理决策并保存投资"""
        # AI决策
        decision = self._ai_decision(situation, options, player_echo)
        
        # 保存投资到数据库
        if decision.get('investment'):
            inv = decision['investment']
            db.save_investment(
                username=self.person.username,
                session_id=self.person.session_id,
                name=inv['name'],
                amount=inv['amount'],
                investment_type=inv['type'],
                remaining_months=inv['duration'],
                return_rate=0.08,
                ai_thoughts=decision['ai_thoughts']
            )
            
            # 扣除现金
            self.person.update_attributes({
                'credits': -inv['amount']
            })
        
        return decision
```

### 3. 财务系统
- **资产构成**: 总资产 = 现金 + 投资资产
- **投资类型**: 短期(1-3月)、中期(4-8月)、长期(9月+)
- **收益计算**: 自动处理投资到期和月收益
- **破产检测**: 现金不足时触发游戏结束
- **实时同步**: 所有操作立即保存到数据库
- **多渠道投资**: 首页AI投资、沙盘世界操作均可投资

**核心代码示例：**
```python
# 时间推进 - backend/app/api/routes.py
@router.post("/time/advance")
async def advance_time(data: dict):
    """推进1个月，更新投资"""
    session_id = data['session_id']
    
    with sqlite3.connect(db_path, timeout=10.0) as conn:
        cursor = conn.cursor()
        
        # 更新投资剩余月数
        cursor.execute('''
            UPDATE investments 
            SET remaining_months = remaining_months - 1
            WHERE session_id = ? AND remaining_months > 0
        ''', (session_id,))
        
        # 处理到期投资
        cursor.execute('''
            SELECT name, amount, return_rate
            FROM investments
            WHERE session_id = ? AND remaining_months = 0
        ''', (session_id,))
        
        total_return = 0
        for inv in cursor.fetchall():
            # 计算收益
            total_return += int(inv[1] * (1 + inv[2]))
        
        # 更新现金
        cursor.execute('''
            UPDATE users 
            SET credits = credits + ?
            WHERE id = ?
        ''', (total_return, session_id))
        
        conn.commit()
    
    return {"success": True, "total_return": total_return}
```

### 4. 人格影响
- **决策风格**: 不同MBTI类型有不同的风险偏好
- **思考模式**: 逻辑型vs情感型的决策差异
- **压力反应**: 高压力时的决策倾向变化
- **社交影响**: 外向型更容易受他人建议影响

**核心代码示例：**
```javascript
// 前端状态管理 - frontend/src/stores/game.js
export const useGameStore = defineStore('game', {
  state: () => ({
    avatar: null,
    assets: { total: 0, cash: 0, investments: [] },
    aiReflection: '正在思考...',
    currentSituation: '',
    situationOptions: []
  }),
  
  actions: {
    async loadAvatar() {
      const char = JSON.parse(localStorage.getItem('currentCharacter'))
      const res = await axios.get('/api/avatar/status', {
        params: { session_id: char.id }
      })
      
      this.avatar = res.data
      this.assets.total = res.data.total_assets
      this.assets.cash = res.data.cash
    },
    
    async aiInvest() {
      const res = await axios.post('/api/ai/invest', {
        session_id: this.avatar.session_id,
        cash: this.assets.cash,
        mbti: this.avatar.mbti_type
      })
      
      if (res.data.success) {
        await this.loadAvatar() // 刷新数据
      }
    }
  }
})
```


## 八、 项目进度
**此部分将随项目开发做更改**

### ✅ 核心功能完成
- [x] **DeepSeek AI集成** - 真实AI决策和情况生成
- [x] **MBTI人格系统** - 16种类型，各具特色
- [x] **意识回响机制** - 玩家建议影响AI决策
- [x] **完整金融系统** - 投资、交易、现金流管理
- [x] **命运轮盘** - 8种出身背景
- [x] **账户系统** - 登录注册，数据隔离
- [x] **Vue.js前端** - 现代化Web界面
- [x] **数据持久化** - SQLite数据库存储
- [x] **实时更新** - 投资收益、月度收支
- [x] **破产机制** - 现金不足时游戏结束
- [x] **AI自主投资** - AI分析财务状况并自动投资
- [x] **资产分析页面** - 实时显示所有投资项目
- [x] **沙盘世界系统** - 银行、交易所等互动场景
- [x] **时间推进机制** - 月度更新，投资自动结算
- [x] **状态持久化** - 页面切换数据不丢失
- [x] **总资产计算** - 现金+投资的完整资产统计



## 九、 战略愿景：从实验室到生态的演进

### 1. 三步走战略路线
- **第一阶段(0-6月)**: MVP验证核心玩法，完成种子用户积累与数据收集
- **第二阶段(7-24月)**: 平台化运营，实现用户规模突破与业务价值验证
- **第三阶段(3-5年)**: 生态化构筑，成为Z世代首选的金融认知与行为洞察平台

### 2. 核心价值创造
- **用户价值**: 获得有趣、可反思、能成长的"零风险"金融体验
- **教育价值**: 以寓教于乐方式提升Z世代财商素养，履行金融普惠责任
- **数据价值**: 沉淀独特的行为金融数据库，构建个性化用户画像
- **创新价值**: 成为"零风险、高效率"的金融产品敏捷测试平台

### 3. 技术演进路径
- **AI智能体升级**: 多模态交互、情感计算、群体智能协作
- **数字孪生深化**: VR/AR沉浸体验、元宇宙金融世界构建
- **生态开放**: API接口开放，引入券商、保险等第三方金融伙伴
- **移动原生**: iOS/Android应用，随时随地的财富人生体验




## 许可证

- **MIT License**

## 版权说明
- **该项目由FinAI团队制作，制作者为南京大学学生团队**

---

*在AI的回响中探索金融决策的艺术，在虚拟的试错中获得真实的成长*
